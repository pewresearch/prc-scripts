!function(){"use strict";var e={n:function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,{a:n}),n},d:function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.element,n=window.prcHooks,r=window.wp.i18n,o=window.wp.components,l=window.wp.date,i=window.wp.coreData,a=window.wp.apiFetch,c=e.n(a);function s(e){let{searchRecords:n,onSelect:r,imageSize:o="A3",disableImage:l=!1}=e;return n.map((e=>(0,t.createElement)(m,{item:e,onSelect:r,imageSize:o,disableImage:l})))}function d(e){let{item:n,imageSize:r}=e;const{art:l}=n;if(l&&l[r]){const{rawUrl:e,height:n,width:i,caption:a}=l[r];return(0,t.createElement)(o.CardMedia,null,(0,t.createElement)("img",{src:e,height:n,width:i,alt:a}))}return null}function m(e){let{item:n,onSelect:r,imageSize:i="A3",disableImage:a=!1}=e;if(!n)return null;const c=n.post_title?n.post_title:n.title.rendered,s=n.post_date?n.post_date:n.date,{label:m}=n,u=n.canonical_url;return(0,t.createElement)(o.Card,{onClick:()=>{const e=(e=>{const{post:t,imageSize:n=!1,isRefresh:r=!1}=e;if(console.log("getAttributesFromPost",t),null===t)return{};const o=(0,l.date)("M j, Y",t.date),i={title:t.hasOwnProperty("title")&&t.title.hasOwnProperty("rendered")?t.title.rendered:"",excerpt:t.hasOwnProperty("excerpt")&&t.excerpt.hasOwnProperty("rendered")?t.excerpt.rendered:"",url:t.canonical_url,label:t.hasOwnProperty("label")?t.label:"report",date:o,postId:t.id||t.ID};if(!0!==r&&(i.extra=""),!1!==n&&t.art){const{art:e}=t;i.image=e[n].rawUrl,i.isChartArt=e[n].chartArt}return i})({post:n,imageSize:i,isRefresh:!1});r(e)},size:"small",style:{cursor:"pointer",":hover":{"background-color":"#f3f4f5"}}},(0,t.createElement)(o.CardBody,{style:{display:"flex"}},!a&&(0,t.createElement)("div",{style:{width:"35%",maxWidth:"200px",paddingRight:"1em",paddingTop:"0.5em"}},(0,t.createElement)(d,{item:n,imageSize:i})),(0,t.createElement)("div",null,(0,t.createElement)("div",{style:{fontSize:"0.8em",color:"#666"}},`${m} | ${(0,l.date)("M j, Y",s)}`),(0,t.createElement)("strong",null,c),(0,t.createElement)("div",{style:{fontSize:"0.8em",fontStyle:"italic",color:"#666",lineHeight:"1.5em"}},u))))}function u(e){let{attributes:l,setAttributes:a,disableImage:d=!1,onSelect:u=(()=>{}),onKeyEnter:p=(()=>{}),onKeyESC:h=(()=>{}),onUpdateURL:v=(()=>{})}=e;const{imageSize:E,url:g,postId:w}=l,[y]=(0,i.useEntityProp)("root","site","siteId"),f=1===y?"stub":"post",[b,S]=(0,t.useState)(!!g),[x,P]=(0,t.useState)(g),z=(0,n.useDebounce)(x,500),C=(0,t.useMemo)((()=>!(void 0===z||!z.match(/^(http|https):\/\//))),[z]),[R,_]=(0,t.useState)(null),H=!!z.length,{records:I,isResolving:T}=(0,i.useEntityRecords)("postType",f,{per_page:10,post_parent:0,search:H&&!C?z:"",context:"view"}),A=!(b||C||!I)&&0<I.length,V=!b&&C&&null!==R,k=!b&&!A&&!V;return(0,t.useEffect)((()=>{var e;C&&(S(!0),(e=z,new Promise(((t,n)=>{c()({path:"/prc-api/v2/stub/get-post-by-url",method:"POST",data:{url:e}}).then((e=>{"object"!=typeof e&&n(new Error("post is not an object")),t(e)})).catch((e=>n(e)))}))).then((e=>{_(e),S(!1)})).catch((e=>{console.error("getPostByUrl error",e),_(null),S(!1)})))}),[z,C]),(0,t.useEffect)((()=>{S(T)}),[T]),(0,t.createElement)(o.TabbableContainer,{onNavigate:(e,t)=>console.log("onNavigate:",t)},(0,t.createElement)(o.KeyboardShortcuts,{shortcuts:{esc:()=>{"function"==typeof h&&h()}}},(0,t.createElement)(o.SearchControl,{tabIndex:"0",value:x,onChange:e=>P(e),placeholder:"Climate Change...",autoComplete:"off"})),H&&(0,t.createElement)(t.Fragment,null,b&&(0,t.createElement)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",color:"#666"}},(0,t.createElement)("span",null,"Loading... "),(0,t.createElement)(o.Spinner,null)),k&&(0,t.createElement)("div",{style:{textAlign:"center",color:"#666",paddingTop:"1em"}},(0,t.createElement)("div",{style:{padding:"1em 0"}},(0,t.createElement)("span",null,(0,r.__)("Nothing found.","prc-block-library"))),C&&(0,t.createElement)("span",null,(0,t.createElement)(o.Button,{variant:"secondary",onClick:()=>{v(),a({url:z})}},(0,r.__)("Change the URL","prc-block-library")))),V&&(0,t.createElement)("div",null,(0,t.createElement)(m,{item:R,onSelect:u,imageSize:E,disableImage:d}),(0,t.createElement)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",color:"#666",paddingTop:"1em"}},(0,t.createElement)("span",null,(0,r.__)("Click the item to replace this block's content","prc-block-library")),void 0!==w&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{style:{padding:"1em 0"}},(0,t.createElement)("span",null,(0,r.__)("~ or ~","prc-block-library"))),C&&(0,t.createElement)("span",null,(0,t.createElement)(o.Button,{variant:"secondary",onClick:()=>{v(),a({url:z})}},(0,r.__)("Change the URL","prc-block-library")))))),A&&!C&&(0,t.createElement)(s,{searchRecords:I,onSelect:u,imageSize:E,disableImage:d})))}function p(e){let{level:n,isPressed:r=!1}=e;const l={1:"M9 5h2v10H9v-4H5v4H3V5h2v4h4V5zm6.6 0c-.6.9-1.5 1.7-2.6 2v1h2v7h2V5h-1.4z",2:"M7 5h2v10H7v-4H3v4H1V5h2v4h4V5zm8 8c.5-.4.6-.6 1.1-1.1.4-.4.8-.8 1.2-1.3.3-.4.6-.8.9-1.3.2-.4.3-.8.3-1.3 0-.4-.1-.9-.3-1.3-.2-.4-.4-.7-.8-1-.3-.3-.7-.5-1.2-.6-.5-.2-1-.2-1.5-.2-.4 0-.7 0-1.1.1-.3.1-.7.2-1 .3-.3.1-.6.3-.9.5-.3.2-.6.4-.8.7l1.2 1.2c.3-.3.6-.5 1-.7.4-.2.7-.3 1.2-.3s.9.1 1.3.4c.3.3.5.7.5 1.1 0 .4-.1.8-.4 1.1-.3.5-.6.9-1 1.2-.4.4-1 .9-1.6 1.4-.6.5-1.4 1.1-2.2 1.6V15h8v-2H15z",3:"M12.1 12.2c.4.3.8.5 1.2.7.4.2.9.3 1.4.3.5 0 1-.1 1.4-.3.3-.1.5-.5.5-.8 0-.2 0-.4-.1-.6-.1-.2-.3-.3-.5-.4-.3-.1-.7-.2-1-.3-.5-.1-1-.1-1.5-.1V9.1c.7.1 1.5-.1 2.2-.4.4-.2.6-.5.6-.9 0-.3-.1-.6-.4-.8-.3-.2-.7-.3-1.1-.3-.4 0-.8.1-1.1.3-.4.2-.7.4-1.1.6l-1.2-1.4c.5-.4 1.1-.7 1.6-.9.5-.2 1.2-.3 1.8-.3.5 0 1 .1 1.6.2.4.1.8.3 1.2.5.3.2.6.5.8.8.2.3.3.7.3 1.1 0 .5-.2.9-.5 1.3-.4.4-.9.7-1.5.9v.1c.6.1 1.2.4 1.6.8.4.4.7.9.7 1.5 0 .4-.1.8-.3 1.2-.2.4-.5.7-.9.9-.4.3-.9.4-1.3.5-.5.1-1 .2-1.6.2-.8 0-1.6-.1-2.3-.4-.6-.2-1.1-.6-1.6-1l1.1-1.4zM7 9H3V5H1v10h2v-4h4v4h2V5H7v4z",4:"M9 15H7v-4H3v4H1V5h2v4h4V5h2v10zm10-2h-1v2h-2v-2h-5v-2l4-6h3v6h1v2zm-3-2V7l-2.8 4H16z",5:"M12.1 12.2c.4.3.7.5 1.1.7.4.2.9.3 1.3.3.5 0 1-.1 1.4-.4.4-.3.6-.7.6-1.1 0-.4-.2-.9-.6-1.1-.4-.3-.9-.4-1.4-.4H14c-.1 0-.3 0-.4.1l-.4.1-.5.2-1-.6.3-5h6.4v1.9h-4.3L14 8.8c.2-.1.5-.1.7-.2.2 0 .5-.1.7-.1.5 0 .9.1 1.4.2.4.1.8.3 1.1.6.3.2.6.6.8.9.2.4.3.9.3 1.4 0 .5-.1 1-.3 1.4-.2.4-.5.8-.9 1.1-.4.3-.8.5-1.3.7-.5.2-1 .3-1.5.3-.8 0-1.6-.1-2.3-.4-.6-.2-1.1-.6-1.6-1-.1-.1 1-1.5 1-1.5zM9 15H7v-4H3v4H1V5h2v4h4V5h2v10z",6:"M9 15H7v-4H3v4H1V5h2v4h4V5h2v10zm8.6-7.5c-.2-.2-.5-.4-.8-.5-.6-.2-1.3-.2-1.9 0-.3.1-.6.3-.8.5l-.6.9c-.2.5-.2.9-.2 1.4.4-.3.8-.6 1.2-.8.4-.2.8-.3 1.3-.3.4 0 .8 0 1.2.2.4.1.7.3 1 .6.3.3.5.6.7.9.2.4.3.8.3 1.3s-.1.9-.3 1.4c-.2.4-.5.7-.8 1-.4.3-.8.5-1.2.6-1 .3-2 .3-3 0-.5-.2-1-.5-1.4-.9-.4-.4-.8-.9-1-1.5-.2-.6-.3-1.3-.3-2.1s.1-1.6.4-2.3c.2-.6.6-1.2 1-1.6.4-.4.9-.7 1.4-.9.6-.3 1.1-.4 1.7-.4.7 0 1.4.1 2 .3.5.2 1 .5 1.4.8 0 .1-1.3 1.4-1.3 1.4zm-2.4 5.8c.2 0 .4 0 .6-.1.2 0 .4-.1.5-.2.1-.1.3-.3.4-.5.1-.2.1-.5.1-.7 0-.4-.1-.8-.4-1.1-.3-.2-.7-.3-1.1-.3-.3 0-.7.1-1 .2-.4.2-.7.4-1 .7 0 .3.1.7.3 1 .1.2.3.4.4.6.2.1.3.3.5.3.2.1.5.2.7.1z"};return l.hasOwnProperty(n)?(0,t.createElement)(o.SVG,{width:"24",height:"24",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",isPressed:r},(0,t.createElement)(o.Path,{d:l[n]})):null}var h=window.wp.data,v=window.wp.htmlEntities,E=window.wp.primitives,g=(0,t.createElement)(E.SVG,{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,t.createElement)(E.Path,{d:"M8 7h2V5H8v2zm0 6h2v-2H8v2zm0 6h2v-2H8v2zm6-14v2h2V5h-2zm0 8h2v-2h-2v2zm0 6h2v-2h-2v2z"}));const w={seed(e){return{type:"SEED",items:e}},append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{type:"APPEND",items:t}},prepend(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{type:"PREPEND",items:t}},insert(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{type:"INSERT",index:e,items:n}},apply(e){return{type:"APPLY",fn:e}},remove(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{type:"REMOVE",indexes:t}},reorder(e){let{from:t,to:n}=e;return{type:"REORDER",from:t,to:n}},setItem(e,t){return{type:"SET_ITEM",index:e,item:t}},setItemProp(e,t,n){return{type:"SET_ITEM_PROP",index:e,prop:t,value:n}}};var y=w;const f=[];var b=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;const n=[...e];switch(t.type){case"SEED":return[...t.items];case"APPEND":return[...e,...t.items];case"PREPEND":return[...t.items,...e];case"INSERT":return[...e.slice(0,t.index),...t.items,...e.slice(t.index)];case"APPLY":return e.map(((e,n)=>t.fn(e,n)));case"REMOVE":return e.filter(((e,n)=>!t.indexes.includes(n)));case"REORDER":const r=e[t.from];return n.splice(t.from,1),n.splice(t.to,0,r),n;case"SET_ITEM":return n[t.index]=t.item,n;case"SET_ITEM_PROP":return n[t.index]={...n[t.index],[t.prop]:t.value},n}return e};function S(e,t){window.prcComponents[e]||(window.prcComponents[e]=t)}window.prcComponents={},S("URLSearchField",u),S("URLSearchToolbar",(function(e){let{attributes:n,setAttributes:l,onSelect:a=(()=>{})}=e;const[c]=(0,i.useEntityProp)("root","site","siteId"),s=1===c?"stub":"post",[d,m]=(0,t.useState)(!1);return(0,t.createElement)(o.ToolbarGroup,null,(0,t.createElement)(o.ToolbarButton,{"aria-expanded":d,"aria-haspopup":"true",label:(0,r.__)(`Search for a ${s} or paste url here`,"prc-block-library"),icon:"admin-links",onClick:()=>m(!0),showTooltip:!0}),!0===d&&(0,t.createElement)(o.Modal,{title:(0,r.__)(`Search for a ${s} or paste url here`,"prc-block-library"),onRequestClose:()=>m(!1),shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},(0,t.createElement)("div",{style:{width:"100%",minWidth:"340px",maxWidth:"640px",margin:"0 auto"}},(0,t.createElement)(u,{attributes:n,setAttributes:l,onSelect:e=>{a(e),m(!1)},onKeyEnter:()=>m(!1),onKeyESC:()=>m(!1),onUpdateURL:()=>{m(!1)}}))))})),S("HeadingLevelToolbar",(function(e){let{selectedLevel:n,levels:l=[2,3],onChange:i,Icon:a=p}=e;console.log("HeadingLevelToolbar",n);const c=(0,t.useCallback)((()=>(0,t.createElement)(a,{level:n,isPressed:!0})),[n]);return(0,t.createElement)(o.ToolbarGroup,null,(0,t.createElement)(o.ToolbarDropdownMenu,{icon:c,label:"Select Heading Size",controls:l.map((e=>{const o=e===n;return{title:(0,r.sprintf)(
// translators: %s: heading level e.g: "1", "2", "3"
(0,r.__)("Heading %d"),e),icon:(0,t.createElement)(a,{level:e,isPressed:o}),isActive:o,onClick:()=>i(e)}}))}))})),S("registerListStore",(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!1!==t&&!1!==n||console.warn("registerListStore requires at least one resolver and one selector","resolvers:",t,"selectors",n);const r=(0,h.createReduxStore)(e,{reducer:b,actions:y,selectors:n,controls:{},resolvers:t});console.log("Registering custom Redux store...",e),(0,h.register)(r)})),S("ListStoreItem",(function(e){let{label:n,icon:r=!1,defaultLabel:l,keyValue:i,onRemove:a=!1,index:c,children:s,storeName:d="report",lastItem:m=!1}=e;const{remove:u}=(0,h.useDispatch)(`prc/${d}`),[p,E]=(0,t.useState)(void 0!==n?n:l);return(0,t.useEffect)((()=>{console.log("getPostTitleByKey",n,l,i,c,d),void 0===n&&void 0!==i&&(e=>{const{api:t}=window.wp,n=new t.models.Post({id:e});null===e?E(l):n.fetch().then((e=>{console.log(e),E(`${(0,v.decodeEntities)(e.title.rendered)} (${e.id})`)}))})(i)}),[i]),(0,t.createElement)("div",{style:{background:"white",paddingBottom:"1em",marginBottom:"1em",borderBottom:m?"none":"1px solid #EAEAEA"}},(0,t.createElement)("div",{style:{display:"flex",flexDirection:"row",width:"100%",alignItems:"center"}},(0,t.createElement)("div",{style:{display:"flex"}},(0,t.createElement)(o.Icon,{icon:g})),(0,t.createElement)("div",{style:{display:"flex",flexGrow:"1",paddingLeft:"1em"}},!1!==r&&{icon:r},(0,t.createElement)("span",null,p)),(0,t.createElement)("div",{style:{display:"flex"}},(0,t.createElement)(o.IconButton,{icon:"no-alt",onClick:()=>{!1!==a&&"function"==typeof a&&a(),u(c)}}))),s)})),S("listStoreActions",y),S("listStoreReducer",b),console.log("Loading @prc/components...",window.prcComponents)}();
//# sourceMappingURL=index.js.map